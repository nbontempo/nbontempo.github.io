<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="renderer" content="webkit">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <title>Introdu√ß√£o de redes - Nicolas Bontempo</title>
  
  <meta name="description" content="Decidi revisar um pouco a mat√©ria de redes, espero que forme um conte√∫do valoroso para todos, assim como √© para mim.
Redes Computadores se comunicam (trocam dados) com o objetivo de gerar valor para os dois lados, cada lado da rede precisa de alguma coisa e por isso est√£o comunicando. Por inst√¢ncia, voc√™ chama o Facebook para conversar com seus amigos e o Facebook responde para ganhar dinheiro com propaganda.">
  <meta name="author" content="Nicolas Bontempo">
  
  <link href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700,700i" rel="stylesheet">
  <link href="https://cdn.bootcss.com/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet">
  <link href="/css/style.css" rel="stylesheet">
  
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">
  <link rel="icon" href="/img/favicon.ico">
  
  <link rel="alternate" type="application/atom+xml" href="/index.xml" title="Nicolas Bontempo">
</head>
<body class="single">
  <header class="header">
    
    <p class="title"><a href="/"><span>üê±‚Äçüëì</span>Nicolas Bontempo</a></p>
    
    <button class="menu-toggle" type="button"></button>
    <nav class="menu">
      <ul>
        
        
        <li class="">
          <a href="/sobre/">About me</a>
        </li>
        
        <li class="">
          <a href="https://github.com/nickbom">Github</a>
        </li>
        
        <li class="">
          <a href="https://www.linkedin.com/in/nicolasbontempo">Linkedin</a>
        </li>
        
        <li class="">
          <a href="/posts/">Posts</a>
        </li>
        
      </ul>
    </nav>
  </header>
  <main class="main">

<article class="post post-view">
  <header class="post-header">
    <h1 class="post-title">Introdu√ß√£o de redes</h1>
    <p class="post-meta">Nicolas Bontempo ¬∑03/03/2017
      <div style="color:grey; font-size:16px;">
        <strong>Tags:</strong> 
        <a href="/tags/redes">redes</a> 
        <a href="/tags/introdu%C3%A7%C3%A3o">introdu√ß√£o</a> 
      </div>
    </p>
  </header>
  <div class="post-content"><p>Decidi revisar um pouco a mat√©ria de redes, espero que forme um conte√∫do valoroso para todos, assim como √© para mim.</p>
<h1 id="redes">Redes</h1>
<p>Computadores se comunicam (trocam dados) com o objetivo de gerar valor para os dois lados, cada lado da rede precisa de alguma coisa e por isso est√£o comunicando. Por inst√¢ncia, voc√™ chama o Facebook para conversar com seus amigos e o Facebook responde para ganhar dinheiro com propaganda.</p>
<p>Uma <strong>rede</strong> pode ser representada por um grafo o qual os v√©rtices s√£o m√°quinas de processamento e as arestas s√£o os links de transmiss√£o. Exemplos de redes incluem Internet, telefones, e at√© walkie-talkies.</p>
<h2 id="protocolos">Protocolos</h2>
<p>Fundamentalmente, sinais s√£o transmitidos pelo espa√ßo. Padr√µes definem o modo pelo qual a informa√ß√£o passa, primeiramente como bits, depois como conceitos de maior n√≠vel.</p>
<p>Os padr√µes podem depender da exist√™ncia de um padr√£o de n√≠vel inferior, formando uma <em>pilha de protocolos</em>. O <strong>modelo OSI</strong> √© uma pilha te√≥rica com as seguintes camadas:</p>
<ul>
<li>F√≠sica: transmite bits atrav√©s de um meio (ex: DSL, 802.11),</li>
<li>Liga√ß√£o de dados: transmiss√£o de frames principalmente atrav√©s de n√≥s adjacentes, para determinar o come√ßo e o fim de uma mensagem (ex: Ethernet, MAC, PPP),</li>
<li>Rede: transmiss√£o de pacotes pelas rotas do grafo (ex: IP, NAT),</li>
<li>Transporte: transmiss√£o de segmentos, assim aplica√ß√µes em ambos endpoints podem trocar mensagens com determinadas garantias de comfiabilidade (ex: TCP, UDP, ICMP (ping)),</li>
<li>Sess√£o: configura√ß√£o e reconhecimento dos endpoints atrav√©s das mensagens,</li>
<li>Apresenta√ß√£o: codifica√ß√£o dos dados (charset, compress√£o, encripta√ß√£o) (ex: TLS, HTTP com MIME para alguma extens√£o),</li>
<li>Aplica√ß√£o: serializa√ß√£o das estruturas de dados (ex: HTTP (documentos), NTP (tempo), SMTP (email), FTP (arquivos)).</li>
</ul>
<p>Agora vamos ver uma pilha baseada na te√≥rica OSI.</p>
<h3 id="http">HTTP</h3>
<p><strong>HyperText Transfer Protocol</strong> (<a href="https://tools.ietf.org/html/rfc2616">HTTP</a>) √© um protocolo da camada de aplica√ß√£o designed para transmiss√£o de documentos por cliente-servidor. Por inst√¢ncia, para requisitar a p√°gina principal de um servidor HTTP pelo seu computador:</p>
<pre><code>GET / HTTP/1.1
Host: localhost:1234
Accept: text/html
</code></pre>
<p>(Cada nova linha √© constitu√≠da por dois bytes: 0x0D e 0x0A, CR-LF; ele termina com duas novas linhas). O servidor pode responder:</p>
<pre><code>HTTP/1.1 200 OK
Content-Type: text/html
Date: Sat, 31 Dec 2016 15:31:45 GMT
Connection: keep-alive
Transfer-Encoding: chunked

7E
&lt;!doctype html&gt;
&lt;html&gt;
 &lt;head&gt;
  &lt;meta charset=utf-8&gt;
  &lt;title&gt; This is HTML &lt;/title&gt;
 &lt;/head&gt;
 &lt;body&gt;&lt;/body&gt;
&lt;/html&gt;

0
</code></pre>
<p>Essa resposta inclue o arquivo <a href="https://html.spec.whatwg.org/multipage/">HTML</a> que o cliente HTTP (usualmente, o browser, como o Firefox ou o Google Chrome) vai ler as instru√ß√µes de como criar a p√°gina, o que determina os pixels que devem ser mostrados, as anima√ß√µes que devem ser mostradas, as intera√ß√µes a serem executadas quando um usu√°rio se move pela p√°gina ou clica o mouse, o som a ser reproduzido, etc.</p>
<p>Todas as requisi√ß√µes t√™m a primeira linha com o m√©todo (<code>GET</code>), um caminho (<code>/</code>), e um protocolo (<code>HTTP/1.1</code>), seguidos pelo cabe√ßalho mapeando nomes de cabe√ßalhos (<code>Accept</code>) para o seu valor (<code>text/html</code>). As solicita√ß√µes tamb√©m podem levar dados.</p>
<p>Respostas tem a primeira linha com o protocolo (<code>HTTP/1.1</code>), um c√≥digo (<code>200 OK</code>; c√≥digo iniciado com 1 s√£o informacionais, 2 para sucesso, 3 para redirecionamento, 4 para erro no cliente, 5 para erro no servidor). Respostas usualmente trazem dados (no exemplo, um c√≥digo HTML), e tamb√©m possui o cabe√ßalho, o qual explica quais s√£o os dados, e qual o seu encode (charset, compress√£o), que horas s√£o, se est√° usando cache, como guardar informa√ß√µes de sess√£o (atrav√©s de cookies) e outras coisas.</p>
<p>Como mencionado, HTTP inclui uma camada de apresenta√ß√£o &ldquo;protocolos&rdquo; nos cabe√ßalhos, como o <strong>Multipurpose Internet Mail Extensions</strong> (<a href="https://tools.ietf.org/html/rfc2045">MIME</a>) no <code>Content-Type</code>, para especificar o arquivo <code>&lt;tipo&gt;/&lt;subtipo&gt;</code> (ex. <code>text/plain</code>), ou se recursivamente cont√©m subarquivos com <code>multipart/mixed</code> ou <a href="https://tools.ietf.org/html/rfc7578"><code>multipart/form-data</code></a>, em que cada subarquivo especifica o seu pr√≥prio cabe√ßalho:</p>
<pre><code>POST /upload HTTP/1.1
Host: localhost:1234
Content-Length: 882
Content-Type: multipart/form-data; boundary=random0ACxeUx4Nxqy3roVtMxrAw

--random0ACxeUx4Nxqy3roVtMxrAw
Content-Disposition: form-data; name=&quot;name-of-first-part&quot;
Content-Type: text/plain

This first file contains normal plain text.
--random0ACxeUx4Nxqy3roVtMxrAw
Content-Disposition: form-data; name=&quot;multiple-images&quot;; filename=&quot;image.svg&quot;
Content-Type: image/svg+xml; charset=UTF-8

&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;100&quot; height=&quot;20&quot;&gt;
  &lt;text x=&quot;10&quot; y=&quot;15&quot;&gt;This is an image&lt;/text&gt;
&lt;/svg&gt;
--random0ACxeUx4Nxqy3roVtMxrAw
Content-Disposition: form-data; name=&quot;multiple-images&quot;; filename=&quot;image.png&quot;
Content-Type: image/png
Content-Transfer-Encoding: base64

iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAAXNSR0IArs4c6QAAAARnQU1BAACx
jwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAMSURBVBhXY2BgYAAAAAQAAVzN/2kAAAAASUVO
RK5CYII=
--random0ACxeUx4Nxqy3roVtMxrAw--
</code></pre>
<p>(Note o uso de base64 na image.png est√° depreciado; na vida real, ele seria substituido pelos dados bin√°rios diretamente.)</p>
<p>HTTPS √© similar ao HTTP, exceto por todo o fluxo de dados, incluindo o cabe√ßalho, √© encriptado para previnir n√≥s intermedi√°rios na rede de ler ou modificar o conte√∫do, o qual √© necess√°rio quando transmitindo identifica√ß√µes ou informa√ß√µes bancarias, e para previnir ser passado como um tolo performando perigosos atos.</p>
<h3 id="tcp">TCP</h3>
<p><strong>Transmission Control Protocol</strong> (<a href="https://tools.ietf.org/html/rfc793">TCP</a>) √© um protocolo da camada de transporte que garante que os segmentos s√£o recebidos sem erros na ordem em que eles s√£o enviados.
Quando usado IP, ele corta os segmentos em peda√ßos que cabem em um pacote.</p>
<ol>
<li>O servidor inicia a ouvir uma porta.</li>
<li>O cliente inicia uma conex√£o com SYN(n√∫mero de sequenciamento).</li>
<li>O servidor informa o cliente que recebeu com o SYN+ACK(n√∫mero de confirma√ß√£o).</li>
<li>O cliente envia um ACK.</li>
<li>O servidor e o cliente agora pode enviar uma s√©rie de pacotes entre eles, e eles enviam ACK para confirmar cada recebimento e se todos os pacotes pr√©vios foram recebidos em ordem.</li>
<li>O cliente envia um FIN(sem mais dados para enviar).</li>
<li>O servidor envia um FIN+ACK (ou um ACK seguido por um FIN).</li>
<li>O cliente envia um ACK. (A conex√£o permace aberta at√© dar time out.)</li>
</ol>
<p>Um cabe√ßalho TCP inclue:</p>
<ul>
<li>Porta de origim em 2 bytes,</li>
<li>Porta de destino em 2 bytes,</li>
<li>N√∫mero de sequenciamento 4 bytes:
<ul>
<li>Em um SYN, o qual √© o n√∫mero de sequenciamento inicial (ISN) escolhido randomicamente,</li>
<li>ou pode ser (server ISN) + 1 + n√∫mero de bytes enviado previamente, garantindo que os pacotes podem ser reordenados para obter o segmento inicial.</li>
</ul>
</li>
<li>N√∫mero de confirma√ß√£o 4 bytes:
<ul>
<li>Em um SYN-ACK, esse √© (cliente ISN) + 1, e n√∫mero de sequenciamento do servidor √© escolhido randomicamente,</li>
<li>Em um ACK, esse √© (server ISN) + n√∫mero de bytes recebidos + 1, o qual √© o pr√≥ximo n√∫mero de sequencia a ser recebedor pelo servidor.</li>
</ul>
</li>
<li>Offset dos dados 4 bits, o tamanho do cabe√ßalho TCP em palavras de 32-bit (padr√£o em 5),</li>
<li>000 (reservado),</li>
<li>Marca√ß√µes(flags) em 9 bits: NS, CWR, ECE, URG (ponteiro de leitura urgente), ACK (numero de confirma√ß√£o de receber dados ou SYN), PSH (enviar dados do buffer para a aplica√ß√£o), RST (reset a conex√£o), SYN (sincronizar o n√∫mero de sequenciamento, usado apenas no handshake inicial), FIN (fim dos dados, usado apenas no fim do handshake),</li>
<li>tamanho da janela 2 bytes, possibilitando fluxo e controle dos dados,</li>
<li>checksum 2 bytes para checar corrup√ß√£o do cabe√ßalho ou dos dados,</li>
<li>ponteiro urgente 2 bytes apontando para um n√∫mero de sequencia,</li>
</ul>
<h3 id="ip">IP</h3>
<p><strong>Internet Protocol</strong> (<a href="https://tools.ietf.org/html/rfc791">IP</a>) √© um protocolo da camada de rede que garante que os pacotes ir√£o para o destino correto mesmo passando por diversas m√°quinas pelo caminho.</p>
<p>Al√©m disso, corta o pacote em fragmentos que cabem dentro de um frame da camada de link.</p>
<p>Fragmentar e reordenar o pacote para outro fim foi projetado para casos os quais o pacote precisa ser transmitido por um link, o qual n√£o pode enviar todo o pacote (tipicamente, um valor m√°ximo de tamanho para um fra√ß√£o na conex√£o ethernet ou quando o destino n√£o tem mem√≥ria o bastante para guardar o pacote).</p>
<p>Assim, o TCP pode dividir os dados arbitrariamente em pacotes menores para caber em um frame ethernet, e a fragmenta√ß√£o diminui a seguran√ßa, j√° que a cauda dos fragmentos n√£o guardam o cabe√ßalho TCP. Al√©m disso, o caminho MTU (transporte maximo de unidade) descoberto (PMTUD) possibilita determinar o tamanho do frame na camada f√≠sica atrav√©s da rede. Como resultado, o IPV6 n√£o habilita a fragmenta√ß√£o de pacotes com o caminho, necessitando que o envio seja em ambas as formas com seu tamanho correto (para TCP), ou em forma de fragmentos no tamanho correto (para UDP e ICMP, os quais n√£o podem dividir os dados em multiplos pacotes).</p>
<p>Note que pacotes podem ser perdidos, dusplicados, recebidos fora de ordem, ou corrompidos sem que a camada de IP note. O pr√≥prio TCP √© respons√°vel por previnir que isso n√£o aconte√ßa.</p>
<p>Endere√ßos IP segmentam a internet em cada vez menores sub-redes, as quais <strong>roteadores</strong> processam os pacotes dentro e atrav√©s das redes. Isso pode manualmente mudar ou obtidos automaticamente pelo <strong>Protocolo de configura√ß√£o do host</strong> (DHCP).</p>
<p>Endere√ßos IPv4 possuem 4 bytes, comumente escritos em decimais separados por pontos, ex. <code>192.168.0.200</code>.</p>
<p>Endere√ßos IPv6 possuem 16 bytes, os quais pares de bytes representam n√∫meros hexadecimais separador por dois pontos, os quais zeros podem opcionalmente serem subtituidos por dois pontos duplos, ex. <code>ff02::1:ff00:0</code></p>
<p>Alguns endere√ßos IPs podem ser mapeados para um nome (ex, <code>google.com.br</code> ‚Üí 201.17.165.177) utilizando o <strong>Domais name system</strong> (DNS), um sistema de nomea√ß√£o para entidades da internet. Companhias que podem alocar novos dom√≠nios s√£o conhecidos como registradores. Eles publicam as suas informa√ß√µes como arquivos de zonas, e possibilitam edi√ß√£o autenticada desses arquivos pelo dom√≠nio dos propriet√°rios. [IP]: <a href="https://tools.ietf.org/html/rfc791">https://tools.ietf.org/html/rfc791</a></p>
<p><em>Enquanto o HTTP requer o TCP, o qual requer IP, protocolos de layers mais baixos s√£o usualmente insubstitu√≠veis.</em></p>
<h3 id="ethernet">Ethernet</h3>
<p>Na camada do link, comunica√ß√£o basicamente ocorre diretamente entre dois n√≥s adjacentes.</p>
<p>Dentro dos protocolos da camada de link, <strong>Ethernet</strong> (LAN, IEEE 802.3) √© uma camada de link, protocolo para transmitir pacotes atrav√©s de um fio entre duas m√°quinas.</p>
<p>A Ethernet sobrevive gra√ßas a <strong>repetidores</strong> para transmitir dados por longas dist√¢ncias, j√° que a camada f√≠sica usualmente possui cabos com comprimentos m√°ximos. Diversas m√°quinas s√£o conectadas a um repetidor, criando uma topologia de estrela. <strong>Pontes</strong> s√£o m√°quinas inteligentes que se lembram do endere√ßo MAC que enviou os dados e usam essa informa√ß√£o para fugir de envios de pacotes para m√°quinas que n√£o s√£o o destino de acordo com o pacote. <strong>Switches</strong> s√£o m√°quinas program√°veis inteligentes que detectam e bloqueiam pacotes corrompidos.</p>
<p>Uma alternativa a Ethernet √© a <strong>WiFi</strong> (WLAN, IEEE 802.11), o protocolo comum de wireless.</p>
<h2 id="layouts-de-redes">Layouts de redes</h2>
<p><strong>Distribu√≠dos</strong> s√£o sistemas os quais dependem de m√∫ltiplos pontos computacionais comunicando.</p>
<p><strong>Cliente-servidor</strong> (Modelo Estrela) √© uma arquitetura que possui uma unidade especial, o servidor, o qual recebe requests de diversas unidades computacionais (clientes), processa o request, e envia a resposta para cada request. Exemplo o HTTP.</p>
<p><strong>Arquitetura em tr√™s camadas</strong> arquitetura que separa os n√≥s em tr√™s tipos:</p>
<ul>
<li>Camada de apresenta√ß√£o: l√™ os dados de entrada e mostra a interface de usu√°rio (UI). Tipicamente, notebooks e celulares.</li>
<li>Camada de neg√≥cio: executas queries de usu√°rios e move dados.</li>
<li>Camada de dados: gerencia os dados, tipicamente atrav√©s de uma Cria√ß√£o-Leitura-Atualiza√ß√£o-Remo√ß√£o (CRUD), Application Programming Interfaces (APIs), tipicamente garantindo atomicidade-consistencia-isola√ß√£o-durabilidade (ACID).</li>
</ul>
<p><strong>Arquitetura multi camada</strong> √© quando a arquitetura em tr√™s camadas possui sub camadas.</p>
<p><strong>Descentralizado</strong> arquitetura que tem a capacidade de perder qualquer n√≥ e se manter. Ex. inclui Hash Tables Distribuidos (DHT).</p>
<p><strong>Peer-to-peer</strong> (P2P) arquitetura que se sustenta com a perda de qualquer n√∫mero de n√≥s, enquanto existir um n√≥ sempre vai existir uma rede. Ex. incluem Bittorrent, Bitcoin e alguns tipos de arquivos de sistema.</p>
</div>
  <footer class="post-footer">
    
    <ul class="post-tags">
      
      <li>
        <a href="/tags/redes/">redes</a>
      </li>
      
      <li>
        <a href="/tags/introdu%C3%A7%C3%A3o/">introdu√ß√£o</a>
      </li>
      
    </ul>
    
  </footer>
  
   
  <div id="disqus_thread"></div>
  <script>
    var disqus_shortname = 'nicolasbontempo';
    (function () { 
      var d = document,
        s = d.createElement('script');
      s.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>
    Please enable JavaScript to view the
    <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
  </noscript>
  
   
</article>
</main>
<footer class="footer">
  <span>&copy; 2015-2020 Nicolas Bontempo üéâ</span>
</footer>
<script src="https://cdn.bootcss.com/instantclick/3.0.1/instantclick.min.js" data-no-instant></script>
<script data-no-instant>InstantClick.init();</script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js" data-no-instant></script>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-71553462-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

<script data-no-instant>
  hljs.initHighlightingOnLoad();
  menuToggle();
  InstantClick.on('change', function() {
    var blocks = document.querySelectorAll('pre code');
    for (var i = 0; i < blocks.length; i++) {
      hljs.highlightBlock(blocks[i]);
    }
    menuToggle();
  });
  function menuToggle() {
    var $toggle = document.querySelector('.menu-toggle');
    if (!$toggle.offsetParent) {
      return;
    }
    var $body = document.querySelector('body');
    $toggle.addEventListener('click', function() {
      $body.classList.toggle('noscroll');
    }, false);
  }
</script>
</body>
</html>
